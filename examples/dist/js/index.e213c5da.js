(function(e){function t(t){for(var i,s,o=t[0],c=t[1],l=t[2],m=0,d=[];m<o.length;m++)s=o[m],a[s]&&d.push(a[s][0]),a[s]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);u&&u(t);while(d.length)d.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(i=!1)}i&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var i={},a={index:0},r=[];function s(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=i,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("c31f")},"04f4":function(e,t,n){"use strict";var i=n("26f7"),a=n.n(i);a.a},"0af2":function(e,t,n){},"0e15":function(e,t,n){"use strict";var i=n("9768"),a=n.n(i);a.a},1021:function(e,t,n){},"107a":function(e,t,n){},"15cf":function(e,t,n){},1663:function(e,t,n){"use strict";var i=n("e86c"),a=n.n(i);a.a},"1e45":function(e,t,n){"use strict";var i=n("83d7"),a=n.n(i);a.a},"26f7":function(e,t,n){},"2ec9":function(e,t){},3423:function(e,t,n){"use strict";var i=n("107a"),a=n.n(i);a.a},"436f":function(e,t,n){"use strict";var i=n("0af2"),a=n.n(i);a.a},"49c2":function(e,t,n){"use strict";var i=n("acce"),a=n.n(i);a.a},"4d21":function(e,t,n){"use strict";var i=n("917b"),a=n.n(i);a.a},"6a2b":function(e,t,n){},"6da9":function(e,t,n){},7802:function(e,t,n){},"820e":function(e,t,n){},"83d7":function(e,t,n){},"909e":function(e,t,n){"use strict";var i=n("1021"),a=n.n(i);a.a},"917b":function(e,t,n){},9768:function(e,t,n){},9800:function(e,t,n){},"9b01":function(e,t,n){"use strict";var i=n("6da9"),a=n.n(i);a.a},"9c9b":function(e,t,n){"use strict";var i=n("9800"),a=n.n(i);a.a},a215:function(e,t,n){},acce:function(e,t,n){},c31f:function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var i=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"imui-center"},[n("lemon-imui",{ref:"IMUI",attrs:{user:e.user},on:{"change-menu":e.handleChangeMenu,"change-contact":e.handleChangeContact,"pull-messages":e.handlePullMessages,send:e.handleSend},scopedSlots:e._u([{key:"cover",fn:function(){return[n("h1",{staticStyle:{"text-indent":"20px"}},[e._v("自定义封面内容")])]},proxy:!0},{key:"contact-title",fn:function(t){return[n("span",[e._v(e._s(t.displayName))]),n("small",{staticClass:"more",on:{click:function(n){return e.changeDrawer(t)}}},[e._v("…")])]}}])}),n("div",{staticClass:"action"},[n("lemon-button",{on:{click:e.appendMessage}},[e._v("发送消息")]),n("lemon-button",{on:{click:e.updateContact}},[e._v("修改联系人信息")])],1)],1)])},r=[],s=(n("8e6e"),n("ac6a"),n("456d"),n("bd86"));n("c5f6"),n("6b54");function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(n,!0).forEach(function(t){Object(s["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var l,u,m,d,f,p,h,g,v,b,x=function(){return(new Date).getTime()},y=function(){return Number(Math.random().toString().substr(3,length)+Date.now()).toString(36)},_=function(){return Math.random().toString(36).substr(2)},w=function(){return{id:y(),status:"succeed",type:"text",sendTime:x(),content:_(),toContactId:"123",fromUser:{id:"222",displayName:"系统测试",avatar:"http://upload.qqbodys.com/allimg/1710/1035512943-0.jpg"}}},j={name:"app",data:function(){return{user:{id:"superadmin",displayName:"IMUI super",avatar:"http://upload.qqbodys.com/img/weixin/20170804/ji5qxg1am5ztm.jpg"}}},mounted:function(){var e=this.$createElement,t={id:"1",displayName:"工作协作群",avatar:"http://upload.qqbodys.com/img/weixin/20170804/ji5qxg1am5ztm.jpg",type:"single",index:"A",unread:0,lastSendTime:1566047865417,lastContent:"2"},n={id:"2",displayName:"狗蛋Li。",avatar:"http://upload.qqbodys.com/img/weixin/20170807/jibfvfd00npin.jpg",type:"single",index:"B",click:function(e){e()},renderContainer:function(){return e("h1",{style:"text-indent:20px"},["自定义页面"])},lastSendTime:1345209465e3,lastContent:"12312",unread:2},i={id:"3",displayName:"铁牛",avatar:"http://upload.qqbodys.com/img/weixin/20170803/jiq4nzrkrnd0e.jpg",type:"many",index:"C",unread:32,lastSendTime:3,lastContent:"你好123"},a=this.$refs.IMUI;setTimeout(function(){},2e3);var r=[c({},t),c({},n),c({},i)];a.initContacts(r),a.initMenus([{name:"lastMessages"},{name:"contacts"},{title:"自定义按钮",unread:0,click:function(){alert("点击了自定义按钮")},render:function(t){return e("span",["T"])},isBottom:!0}]),a.initEmoji([{label:"表情",children:[{name:"1f600",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f600.png"},{name:"1f62c",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f62c.png"},{name:"1f601",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f601.png"},{name:"1f602",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f602.png"},{name:"1f923",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f923.png"},{name:"1f973",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f973.png"},{name:"1f603",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f603.png"},{name:"1f604",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f604.png"},{name:"1f605",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f605.png"},{name:"1f606",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f606.png"},{name:"1f607",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f607.png"},{name:"1f609",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f609.png"},{name:"1f60a",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f60a.png"},{name:"1f642",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f642.png"},{name:"1f643",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f643.png"},{name:"1263a",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/263a.png"},{name:"1f60b",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f60b.png"},{name:"1f60c",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f60c.png"},{name:"1f60d",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f60d.png"},{name:"1f970",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f970.png"},{name:"1f618",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f618.png"},{name:"1f617",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f617.png"},{name:"1f619",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f619.png"},{name:"1f61a",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f61a.png"},{name:"1f61c",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f61c.png"},{name:"1f92a",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f92a.png"},{name:"1f928",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f928.png"},{name:"1f9d0",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f9d0.png"},{name:"1f61d",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f61d.png"},{name:"1f61b",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f61b.png"},{name:"1f911",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f911.png"},{name:"1f913",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f913.png"},{name:"1f60e",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f60e.png"},{name:"1f929",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f929.png"},{name:"1f921",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f921.png"},{name:"1f920",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f920.png"},{name:"1f917",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f917.png"},{name:"1f60f",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f60f.png"},{name:"1f636",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f636.png"},{name:"1f610",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f610.png"},{name:"1f611",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f611.png"},{name:"1f612",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f612.png"},{name:"1f644",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f644.png"},{name:"1f914",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f914.png"},{name:"1f925",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f925.png"},{name:"1f92d",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f92d.png"},{name:"1f92b",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f92b.png"},{name:"1f92c",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f92c.png"},{name:"1f92f",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f92f.png"},{name:"1f633",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f633.png"},{name:"1f61e",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f61e.png"},{name:"1f61f",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f61f.png"},{name:"1f620",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f620.png"},{name:"1f621",title:"微笑",src:"https://twemoji.maxcdn.com/2/72x72/1f621.png"}]},{label:"武器",children:[{name:"wx",src:"http://"}]}])},methods:{appendMessage:function(){var e=this.$refs.IMUI,t=e.currentContact,n=w();n.fromUser=c({},n.fromUser,{},this.user),e.appendMessage(n),e.updateContact(t.id,{unread:"+1",lastSendTime:x(),lastContent:e.lastContentRender(n)})},updateContact:function(){this.$refs.IMUI.updateContact("3",{unread:10,displayName:_(),lastSendTime:x(),lastContent:"修改昵称为随机字母"})},changeDrawer:function(e){var t=this.$createElement;this.$refs.IMUI.changeDrawer(function(){return t("div",{class:"drawer-content"},[t("p",[t("b",["自定义抽屉"])]),t("p",[e.displayName])])})},handleChangeContact:function(e){console.log("Event:change-contact"),this.$refs.IMUI.updateContact(e.id,{unread:0}),this.$refs.IMUI.closeDrawer()},handleSend:function(e,t,n){console.log("Event:send"),setTimeout(function(){t()},1e3)},handlePullMessages:function(e,t){console.log("Event:pull-messages");var n=[{id:"8ad7e98e-5225-4892-8131-4b2ee7797599",type:"text",status:"succeed",sendTime:1564926674646,fromContactId:"superadmin",fromUser:{id:"hehe",displayName:"I KNOEW",avatar:"https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=4085009425,1005454674&fm=26&gp=0.jpg"},content:"测试消息哦..."},{id:"8ad7e98e-5225-4892-8131-4b2ee7797599",type:"text",status:"succeed",sendTime:1564926674646,fromContactId:"superadmin",fromUser:{id:"superadmin",displayName:"超级飞机",avatar:"https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=4085009425,1005454674&fm=26&gp=0.jpg"},content:"测试消息哦..."},{id:"8ad7e98e-5225-4892-8131-4b2ee7797599",type:"text",status:"succeed",sendTime:1564926674646,fromContactId:"superadmin",fromUser:{id:"hehe",displayName:"I KNOEW",avatar:"https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=4085009425,1005454674&fm=26&gp=0.jpg"},content:"测试消息哦..."},{id:"8ad7e98e-5225-4892-8131-4b2ee7797599",type:"text",status:"succeed",sendTime:1564926674646,fromContactId:"superadmin",fromUser:{id:"superadmin",displayName:"超级飞机",avatar:"https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=4085009425,1005454674&fm=26&gp=0.jpg"},content:"测试消息哦..."},{id:"8ad7e98e-5225-4892-8131-4b2ee7797599",type:"text",status:"succeed",sendTime:1564926674646,fromContactId:"superadmin",fromUser:{id:"hehe",displayName:"I KNOEW",avatar:"https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=4085009425,1005454674&fm=26&gp=0.jpg"},content:"测试消息哦..."},{id:"8ad7e98e-5225-4892-8131-4b2ee7797599",type:"text",status:"succeed",sendTime:1564926674646,fromContactId:"superadmin",fromUser:{id:"superadmin",displayName:"超级飞机",avatar:"https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=4085009425,1005454674&fm=26&gp=0.jpg"},content:"测试消息哦..."}];t(n)},handleChangeMenu:function(){console.log("Event:change-menu")},openCustomContainer:function(){}}},O=j,C=(n("9c9b"),n("2877")),S=Object(C["a"])(O,a,r,!1,null,null,null),k=S.exports,M=(n("7f7f"),n("2ec9"),{name:"LemonTabs",props:{activeIndex:String},data:function(){return{active:this.activeIndex}},mounted:function(){this.active||(this.active=this.$slots["tab-pane"][0].data.attrs.index)},render:function(){var e=this,t=arguments[0],n=[],i=[];return this.$slots["tab-pane"].map(function(a){var r=a.data.attrs,s=r.tab,o=r.index;n.push(t("div",{class:"lemon-tabs-content__pane",directives:[{name:"show",value:e.active==o}]},[a])),i.push(t("div",{class:["lemon-tabs-nav__item",e.active==o&&"lemon-tabs-nav__item--active"],on:{click:function(){return e._handleNavClick(o)}}},[s]))}),t("div",{class:"lemon-tabs"},[t("div",{class:"lemon-tabs-content"},[n]),t("div",{class:"lemon-tabs-nav"},[i])])},methods:{_handleNavClick:function(e){this.active=e}}}),I=M,$=(n("3423"),Object(C["a"])(I,l,u,!1,null,null,null)),T=$.exports,E=(n("96cf"),n("3b8d")),D=(n("6762"),n("2fdb"),[]),P=function(){return D.forEach(function(e){return e()})},F={hover:function(e){},focus:function(e){var t=this;e.addEventListener("focus",function(e){t.changeVisible()}),e.addEventListener("blur",function(e){t.changeVisible()})},click:function(e){var t=this;e.addEventListener("click",function(e){e.stopPropagation(),t.changeVisible()})},contextmenu:function(e){var t=this;e.addEventListener("contextmenu",function(e){e.preventDefault(),t.changeVisible()})}},L={name:"LemonPopover",props:{trigger:{type:String,default:"click",validator:function(e){return Object.keys(F).includes(e)}}},data:function(){return{popoverStyle:{},visible:!1}},created:function(){document.addEventListener("click",this._documentClickEvent),D.push(this.close)},mounted:function(){F[this.trigger].call(this,this.$slots.default[0].elm)},render:function(){var e=arguments[0];return e("span",{style:"position:relative"},[e("transition",{attrs:{name:"slide-top"}},[this.visible&&e("div",{class:"lemon-popover",ref:"popover",style:this.popoverStyle,on:{click:function(e){return e.stopPropagation()}}},[e("div",{class:"lemon-popover__title"}),e("div",{class:"lemon-popover__content"},[this.$slots.content]),e("div",{class:"lemon-popover__arrow"})])]),this.$slots.default])},destroyed:function(){document.removeEventListener("click",this._documentClickEvent)},computed:{},watch:{visible:function(){var e=Object(E["a"])(regeneratorRuntime.mark(function e(t){var n,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return e.next=3,this.$nextTick();case 3:n=this.$slots.default[0].elm,i=this.$refs.popover,this.popoverStyle={top:"-".concat(i.offsetHeight+10,"px"),left:"".concat(n.offsetWidth/2-i.offsetWidth/2,"px")};case 6:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},methods:{_documentClickEvent:function(e){e.stopPropagation(),this.visible&&this.close()},changeVisible:function(){this.visible?this.close():this.open()},open:function(){P(),this.visible=!0},close:function(){this.visible=!1}}},R=L,U=(n("0e15"),Object(C["a"])(R,m,d,!1,null,null,null)),N=U.exports,B={name:"LemonButton",props:{disabled:Boolean},render:function(){var e=arguments[0];return e("button",{class:"lemon-button",attrs:{disabled:this.disabled,type:"button"},on:{click:this._handleClick}},[this.$slots.default])},methods:{_handleClick:function(e){this.$emit("click",e)}}},A=B,V=(n("1e45"),Object(C["a"])(A,f,p,!1,null,null,null)),H=V.exports,q={name:"LemonBadge",props:{count:[Number,Boolean],overflowCount:{type:Number,default:99}},render:function(){var e=arguments[0];return e("span",{class:"lemon-badge"},[this.$slots.default,0!==this.count&&void 0!==this.count&&e("span",{class:["lemon-badge__label",this.isDot&&"lemon-badge__label--dot"]},[this.label])])},computed:{isDot:function(){return!0===this.count},label:function(){return this.isDot?"":this.count>this.overflowCount?"".concat(this.overflowCount,"+"):this.count}},methods:{}},K=q,W=(n("dbdc"),Object(C["a"])(K,h,g,!1,null,null,null)),z=W.exports,Y={name:"LemonAvatar",props:{src:String,icon:{type:String,default:"lemon-icon-people"},size:{type:Number,default:32}},data:function(){return{imageFinishLoad:!0}},render:function(){var e=this,t=arguments[0];return t("span",{style:this.style,class:"lemon-avatar",on:{click:function(t){return e.$emit("click",t)}}},[this.imageFinishLoad&&t("i",{class:this.icon}),t("img",{attrs:{src:this.src},on:{load:this._handleLoad}})])},computed:{style:function(){var e="".concat(this.size,"px");return{width:e,height:e,lineHeight:e,fontSize:"".concat(this.size/2,"px")}}},methods:{_handleLoad:function(){this.imageFinishLoad=!1}}},G=Y,Q=(n("04f4"),Object(C["a"])(G,v,b,!1,null,null,null)),J=Q.exports,Z=n("2638"),X=n.n(Z);n("3b2b"),n("8615");function ee(e){return"[object Object]"===Object.prototype.toString.call(e)}function te(e){return"string"==typeof e}function ne(e){return(new Date).getTime()-e<864e5}function ie(e){return!e||(!(!Array.isArray(e)||0!=e.length)||!(!ee(e)||0!=Object.values(e).length))}function ae(e){return e&&"function"===typeof e}n("a481");function re(e,t,n){return e?e(n):t}function se(e){return e<10?"0".concat(e):e}function oe(e){var t,n=new Date(e),i=new Date,a=function(e){return e.getFullYear()},r=function(e){return"".concat(e.getMonth()+1,"-").concat(e.getDate())},s=a(n),o=a(i);return t=s!==o?"y年m月d日 h:i":"".concat(s,"-").concat(r(n))==="".concat(o,"-").concat(r(i))?"h:i":"m月d日 h:i",ce(e,t)}function ce(e,t){t||(t="y-m-d h:i:s"),e=e?new Date(e):new Date;for(var n=[e.getFullYear().toString(),se((e.getMonth()+1).toString()),se(e.getDate().toString()),se(e.getHours().toString()),se(e.getMinutes().toString()),se(e.getSeconds().toString())],i="ymdhis",a=0;a<n.length;a++)t=t.replace(i.charAt(a),n[a]);return t}function le(e,t){ae(e)?e(function(){t()}):t()}function ue(e){throw new Error(e)}function me(e){return e.replace(/<img emoji-name=\"([^\"]*?)\" [^>]*>/gi,"[!$1]")}function de(e){if(null==e||""==e)return"0 Bytes";var t=["B","K","M","G","T","P","E","Z","Y"],n=0,i=parseFloat(e);n=Math.floor(Math.log(i)/Math.log(1024));var a=i/Math.pow(1024,n);return a=parseFloat(a.toFixed(2)),a+t[n]}function fe(){var e=(new Date).getTime();window.performance&&"function"===typeof window.performance.now&&(e+=performance.now());var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)});return t}var pe,he,ge,ve,be,xe,ye,_e,we,je={name:"LemonContact",components:{},data:function(){return{}},props:{contact:Object,simple:Boolean,timeFormat:{type:Function,default:function(e){return ce(e,ne(e)?"h:i":"y/m/d")}}},render:function(){var e=this,t=arguments[0],n=this.contact;return t("div",{class:["lemon-contact",{"lemon-contact--name-center":this.simple}],on:{click:function(t){return e._handleClick(t,n)}}},[t("lemon-badge",{attrs:{count:this.simple?0:n.unread,"native-on-click":function(t){return e._handleBubbleClick(t,n)}},class:"lemon-contact__avatar"},[t("lemon-avatar",{attrs:{size:40,"native-on-click":function(t){return e._handleAvatarClick(t,n)},src:n.avatar}})]),t("div",{class:"lemon-contact__inner"},[t("p",{class:"lemon-contact__label"},[t("span",{class:"lemon-contact__name"},[n.displayName]),!this.simple&&t("span",{class:"lemon-contact__time"},[this.timeFormat(n.lastSendTime)])]),!this.simple&&t("p",{class:"lemon-contact__content"},[te(n.lastContent)?t("span",X()([{},{domProps:{innerHTML:n.lastContent}}])):n.lastContent])])])},created:function(){},mounted:function(){},computed:{},watch:{},methods:{_handleClick:function(e,t){this.$emit("click",t)},_handleAvatarClick:function(e,t){e.stopPropagation(),this.$emit("avatar-click",t)},_handleBubbleClick:function(e,t){e.stopPropagation(),this.$emit("bubble-click",t)}}},Oe=je,Ce=(n("909e"),Object(C["a"])(Oe,pe,he,!1,null,null,null)),Se=Ce.exports,ke=(n("5df3"),n("1c4c"),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"insertHTML";document.execCommand(t,!1,e)}),Me=window.getSelection(),Ie=[],$e={name:"LemonEditor",components:{},props:{},data:function(){return{submitDisabled:!0,accept:""}},created:function(){},mounted:function(){},computed:{},watch:{},render:function(){var e=this,t=arguments[0];return t("div",{class:"lemon-editor"},[t("input",{style:"display:none",attrs:{type:"file",multiple:"multiple",accept:this.accept},ref:"fileInput",on:{change:this._handleChangeFile}}),t("div",{class:"lemon-editor__tool"},[Ie.length>0&&t("lemon-popover",{class:"lemon-editor__emoji"},[t("template",{slot:"content"},[this._renderEmojiTabs()]),t("div",{class:"lemon-editor__tool-item"},[t("i",{class:"lemon-icon-emoji"})])]),t("div",{class:"lemon-editor__tool-item",on:{click:function(){return e._handleSelectFile("*")}}},[t("i",{class:"lemon-icon-folder"})]),t("div",{class:"lemon-editor__tool-item",on:{click:function(){return e._handleSelectFile("image/*")}}},[t("i",{class:"lemon-icon-image"})])]),t("div",{class:"lemon-editor__inner"},[t("div",{class:"lemon-editor__input",ref:"textarea",attrs:{contenteditable:"true",spellcheck:"false"},on:{keyup:this._handleKeyup,keydown:this._handleKeydown,paste:this._handlePaste,click:this._handleClick,input:this._handleInput}})]),t("div",{class:"lemon-editor__footer"},[t("div",{class:"lemon-editor__tip"},["使用 ctrl + enter 快捷发送消息"]),t("div",{class:"lemon-editor__submit"},[t("lemon-button",{attrs:{disabled:this.submitDisabled},on:{click:this._handleSend}},["发 送"])])])])},methods:{_saveLastRange:function(){ge=Me.getRangeAt(0)},_focusLastRange:function(){this.$refs.textarea.focus(),ge&&(Me.removeAllRanges(),Me.addRange(ge))},_handleClick:function(){this._saveLastRange()},_handleInput:function(){this._checkSubmitDisabled()},_renderEmojiTabs:function(){var e=this,t=this.$createElement,n=function(n){return n.map(function(n){return t("img",{attrs:{src:n.src,title:n.title},class:"lemon-editor__emoji-item",on:{click:function(){return e._handleSelectEmoji(n)}}})})};if(Ie[0].label){var i=Ie.map(function(e,i){return t("div",{slot:"tab-pane",attrs:{index:i,tab:e.label}},[n(e.children),n(e.children)])});return t("lemon-tabs",{style:"width: 412px"},[i])}return t("div",{class:"lemon-tabs-content",style:"width:406px"},[n(Ie)])},_handleSelectEmoji:function(e){this._focusLastRange(),ke('<img emoji-name="'.concat(e.name,'" src="').concat(e.src,'"></img>')),this._saveLastRange()},_handleSelectFile:function(){var e=Object(E["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.accept=t,e.next=3,this.$nextTick();case 3:this.$refs.fileInput.click();case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),_handlePaste:function(e){e.preventDefault();var t=e.clipboardData,n=t.getData("text");ke(n,"insertText")},_handleKeyup:function(e){this._saveLastRange()},_handleKeydown:function(e){e.keyCode},getFormatValue:function(){return me(this.$refs.textarea.innerHTML.replace(/<br>|<\/br>/,"").replace(/<div>|<p>/g,"\r\n").replace(/<\/div>|<\/p>/g,""))},_checkSubmitDisabled:function(){this.submitDisabled=!this.$refs.textarea.innerHTML.trim()},_handleSend:function(e){var t=this.getFormatValue();this.$emit("send",t),this.clear(),this._checkSubmitDisabled()},_handleChangeFile:function(e){var t=this,n=this.$refs.fileInput;Array.from(n.files).forEach(function(e){t.$emit("upload",e)}),n.value=""},clear:function(){this.$refs.textarea.innerHTML=""},initEmoji:function(e){Ie=e,this.$forceUpdate()}}},Te=$e,Ee=(n("49c2"),Object(C["a"])(Te,ve,be,!1,null,null,null)),De=Ee.exports,Pe={name:"LemonMessages",components:{},props:{reverseUserId:String,timeRange:{type:Number,default:1},timeFormat:{type:Function,default:function(e){return oe(e)}},messages:{type:Array,default:function(){return[]}}},data:function(){return{loading:!1,loadend:!1}},render:function(){var e=this,t=arguments[0];return t("div",{class:"lemon-messages",ref:"wrap",on:{scroll:this._handleScroll}},[t("div",{class:["lemon-messages__load","lemon-messages__load--".concat(this.loadend?"end":"ing")]},[this.loadend?this._renderLoadEnd():this._renderLoading()]),this.messages.map(function(n,i){var a=[],r="lemon-message-".concat(n.type),s=e.messages[i-1];return s&&e.msecRange&&n.sendTime-s.sendTime>e.msecRange&&a.push(t("lemon-message-event",X()([{},{attrs:{message:{id:"__time__",type:"event",content:e.timeFormat(n.sendTime)}}}]))),a.push(t(r,X()([{ref:"message",refInFor:!0},{attrs:{timeFormat:e.msecRange>0?function(){}:e.timeFormat,message:n,reverse:e.reverseUserId==n.fromUser.id,hiddenTitle:!1}}]))),a})])},computed:{msecRange:function(){return 1e3*this.timeRange*60}},watch:{},methods:{_renderLoading:function(){var e=this.$createElement;return e("i",{class:"lemon-icon-loading lemonani-spin"})},_renderLoadEnd:function(){var e=this.$createElement;return e("span",["暂无消息"])},resetLoadState:function(){this.loading=!1,this.loadend=!1},_handleScroll:function(){var e=Object(E["a"])(regeneratorRuntime.mark(function e(t){var n,i,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.target,0!=n.scrollTop||0!=this.loading||0!=this.loadend){e.next=7;break}return this.loading=!0,e.next=5,this.$nextTick();case 5:i=n.scrollHeight,this.$emit("reach-top",function(){var e=Object(E["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.$nextTick();case 2:n.scrollTop=n.scrollHeight-i,a.loading=!1,a.loadend=!!t;case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),scrollToBottom:function(){var e=Object(E["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:t=this.$refs.wrap,t&&(t.scrollTop=t.scrollHeight);case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},created:function(){},mounted:function(){}},Fe=Pe,Le=(n("436f"),Object(C["a"])(Fe,xe,ye,!1,null,null,null)),Re=Le.exports,Ue={name:"lemonMessageBasic",props:{message:{type:Object,default:function(){return{}}},timeFormat:{type:Function,default:function(){return""}},reverse:Boolean,hiddenTitle:Boolean},data:function(){return{}},render:function(){var e=arguments[0],t=this.message,n=t.fromUser,i=t.status,a=t.sendTime;return e("div",{class:["lemon-message",{"lemon-message--reverse":this.reverse,"lemon-message--hidden-title":this.hiddenTitle}]},[e("div",{class:"lemon-message__avatar"},[e("lemon-avatar",{attrs:{size:36,shape:"square",src:n.avatar},on:{click:function(){console.log("message avatar click")}}})]),e("div",{class:"lemon-message__inner"},[e("div",{class:"lemon-message__title"},[e("span",{on:{click:function(){console.log("message displayname click")}}},[n.displayName]),e("span",{class:"lemon-message__time"},[this.timeFormat(a)])]),e("div",{class:"lemon-message__content",on:{click:function(){console.log("message content click")}}},[this.useScopedSlots("content",this.message)]),e("div",{class:"lemon-message__status"},[this._renderStatue(i)])])])},created:function(){},mounted:function(){},computed:{},watch:{},methods:{_renderStatue:function(e){var t=this.$createElement;return"going"==e?t("i",{class:"lemon-icon-loading lemonani-spin"}):"failed"==e?t("i",{class:"lemon-icon-prompt",attrs:{title:"重发消息"},style:{color:"#ff2525",cursor:"pointer"}}):void 0},useScopedSlots:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this;return i.$scopedSlots[e]?i.$scopedSlots[e](t):n}}},Ne=Ue,Be=(n("fbd1"),Object(C["a"])(Ne,_e,we,!1,null,null,null)),Ae=Be.exports,Ve={inject:["IMUI"],methods:{}};function He(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?He(n,!0).forEach(function(t){Object(s["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):He(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ke,We,ze={name:"lemonMessageText",inheritAttrs:!1,mixins:[Ve],render:function(){var e=this,t=arguments[0];return t("lemon-message-basic",X()([{class:"lemon-message-text"},{props:qe({},this.$attrs)},{scopedSlots:{content:function(n){var i=e.IMUI.replaceEmojiName(n.content);return t("span",X()([{},{domProps:{innerHTML:i}}]))}}}]))}},Ye=ze,Ge=(n("1663"),Object(C["a"])(Ye,Ke,We,!1,null,null,null)),Qe=Ge.exports;function Je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function Ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Je(n,!0).forEach(function(t){Object(s["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Je(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Xe,et,tt={name:"lemonMessageImage",inheritAttrs:!1,render:function(){var e=arguments[0];return e("lemon-message-basic",X()([{class:"lemon-message-image"},{props:Ze({},this.$attrs)},{scopedSlots:{content:function(t){return e("img",{attrs:{src:t.content}})}}}]))}},nt=tt,it=(n("4d21"),Object(C["a"])(nt,Xe,et,!1,null,null,null)),at=it.exports;function rt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function st(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rt(n,!0).forEach(function(t){Object(s["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ot,ct,lt,ut,mt={name:"lemonMessageFile",inheritAttrs:!1,render:function(){var e=arguments[0];return e("lemon-message-basic",X()([{class:"lemon-message-file"},{props:st({},this.$attrs)},{scopedSlots:{content:function(t){return[e("div",{class:"lemon-message-file__inner"},[e("p",{class:"lemon-message-file__name"},[t.fileName]),e("p",{class:"lemon-message-file__byte"},[de(t.fileSize)])]),e("div",{class:"lemon-message-file__sfx"},[e("i",{class:"lemon-icon-attah"})])]}}}]))}},dt=mt,ft=(n("cfab"),Object(C["a"])(dt,ot,ct,!1,null,null,null)),pt=ft.exports,ht={name:"lemonMessageEvent",inheritAttrs:!1,render:function(){var e=arguments[0],t=this.$attrs.message.content;return e("div",{class:"lemon-message lemon-message-event"},[e("span",{class:"lemon-message-event__content"},[t])])}},gt=ht,vt=(n("ed4b"),Object(C["a"])(gt,lt,ut,!1,null,null,null)),bt=vt.exports,xt=(n("20d6"),n("75fc")),yt=(n("f559"),n("6c7b"),n("55dd"),n("7514"),"lastMessages"),_t="contacts",wt=[yt,_t],jt=["voice","file","video","image","text"],Ot=["going","succeed","failed"],Ct=["many","single"],St={voice:function(e){return"[语音]"},file:function(e){return"[文件]"},video:function(e){return"[视频]"},image:function(e){return"[图片]"},text:function(e){return this.replaceEmojiName(e.content)}},kt=n("d225"),Mt=n("b0b4"),It=function(){function e(){Object(kt["a"])(this,e),this.table={}}return Object(Mt["a"])(e,[{key:"get",value:function(e){return e?this.table[e]:this.table}},{key:"set",value:function(e,t){this.table[e]=t}},{key:"remove",value:function(e){e?delete this.table[e]:this.table={}}},{key:"has",value:function(e){return!!this.table[e]}}]),e}(),$t=function(e){return Et(e,{id:!0,displayName:!0,avatar:!0,type:{required:!0,has:Ct}})},Tt=function(e){return Et(e,{content:!0,sendTime:!0,type:{required:!0,has:jt}})};function Et(e,t){return e&&ee(e)||ue("argument must be an object"),Object.keys(t).forEach(function(n){var i=t[n],a=e[n];!0!==i&&!0!==i.required||void 0!==a?i.has&&!i.has.includes(a)&&ue('"'.concat(n,'" cannot be "').concat(a,'",can only be the following data "').concat(i.has,'"')):ue('"'.concat(n,'" cannot be "').concat(a,'" '))}),!0}function Dt(e){$t(e)}function Pt(e){Et(e,{status:{required:!0,has:Ot},fromContactId:!0}),Tt(e),$t(e.fromUser);var t={};switch(e.type){case"file":t={fileSize:!0,fileName:!0};break;case"text":t={text:!0};break}Et(e,t)}function Ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function Lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ft(n,!0).forEach(function(t){Object(s["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ft(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}Dt({id:"123",displayName:"123asd",avatar:"123",type:"single",unread:0,lastSendTime:"",subText:"12312312"}),Pt({id:"123",status:"succeed",type:"image",sendTime:12312312312,content:"asdas",fromContactId:"123",fromUser:{id:"123",displayName:"123",avatar:"123",type:"single"}});var Rt,Ut,Nt=new It,Bt=new It,At=new It,Vt={},Ht={},qt=function(){},Kt={name:"LemonImui",provide:function(){return{IMUI:this}},props:{messageTimeFormat:Function,contactTimeFormat:Function,hideDrawer:{type:Boolean,default:!0},hideMenuAvatar:Boolean,user:{type:Object,default:function(){return{}}}},data:function(){return{drawerVisible:!this.hideDrawer,currentContactId:"",activeSidebar:yt,contacts:[],menus:[]}},render:function(){return this._renderWrapper([this._renderMenu(),this._renderSidebarMessage(),this._renderSidebarContact(),this._renderContainer(),this._renderDrawer()])},created:function(){this.initMenus()},mounted:function(){var e=Object(E["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),computed:{currentMessages:function(){return Vt[this.currentContactId]||[]},currentContact:function(){var e=this;return this.contacts.find(function(t){return t.id==e.currentContactId})||{}},currentMenu:function(){var e=this;return this.menus.find(function(t){return t.name==e.activeSidebar})||{}},currentIsDefSidebar:function(){return wt.includes(this.activeSidebar)},lastMessages:function(){var e=this.contacts.filter(function(e){return!ie(e.lastContent)});return e.sort(function(e,t){return t.lastSendTime-e.lastSendTime}),e}},watch:{activeSidebar:function(){}},methods:{_menuIsContacts:function(){return this.activeSidebar==_t},_menuIsMessages:function(){return this.activeSidebar==yt},_createMessage:function(e){return Lt({},{id:fe(),type:"text",status:"going",sendTime:(new Date).getTime(),toContactId:this.currentContactId,fromUser:Lt({},this.user)},{},e)},appendMessage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentContactId;this._addMessage(e,t,1),this.messageViewToBottom()},_emitSend:function(e,t,n){var i=this;this.$emit("send",e,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{status:"succeed"};t(),e=Object.assign(e,n),i.forceUpdateMessage(e.id)},n)},_handleSend:function(e){var t=this,n=this._createMessage({content:e});this.appendMessage(n),this._emitSend(n,function(){t.updateContact(n.toContactId,{lastContent:t.lastContentRender(n),lastSendTime:n.sendTime})})},_handleUpload:function(e){var t,n=this,i=["image/gif","image/jpeg","image/png"];t=i.includes(e.type)?{type:"image",content:URL.createObjectURL(e)}:{type:"file",fileSize:e.size,fileName:e.name,content:""};var a=this._createMessage(t);this.appendMessage(a),this._emitSend(a,function(){n.updateContact(a.toContactId,{lastContent:n.lastContentRender(a),lastSendTime:a.sendTime})},e)},_handleReachTop:function(e){var t=this;this.$emit("pull-messages",this.currentContact,function(n){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t._addMessage(Array(10).fill(n[1]),t.currentContactId,0),At.set(t.currentContactId,i),e(i)})},clearCacheContainer:function(e){Nt.remove(e),Bt.remove(e)},_renderWrapper:function(e){var t=this.$createElement;return t("div",{class:["lemon-wrapper",this.drawerVisible&&"lemon-wrapper--drawer-show"]},[e])},_renderMenu:function(){var e=this.$createElement,t=this._renderMenuItem();return e("div",{class:"lemon-menu"},[0==this.hideMenuAvatar&&e("lemon-avatar",{on:{click:function(e){console.log("menu avatar click")}},class:"lemon-menu__avatar",attrs:{src:"https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=400062461,2874561526&fm=26&gp=0.jpg"}}),t.top,this.$slots.menu,e("div",{class:"lemon-menu__bottom"},[this.$slots["menu-bottom"],t.bottom])])},_renderMenuAvatar:function(){},_renderMenuItem:function(){var e=this,t=this.$createElement,n=[],i=[];return this.menus.forEach(function(a){var r=a.name,s=a.title,o=a.unread,c=a.render,l=a.click,u=t("div",{class:["lemon-menu__item",{"lemon-menu__item--active":e.activeSidebar==r}],on:{click:function(){le(l,function(){r&&e.changeMenu(r)})}},attrs:{title:s}},[t("lemon-badge",{attrs:{count:o}},[c(a)])]);!0===a.isBottom?i.push(u):n.push(u)}),{top:n,bottom:i}},_renderSidebarMessage:function(){var e=this;return this._renderSidebar(this.lastMessages.map(function(t){return e._renderContact({contact:t,timeFormat:e.contactTimeFormat},function(){return e.changeContact(t.id)})}),yt)},_renderContact:function(e,t){var n=this,i=this.$createElement,a=e.contact,r=a.click,s=a.renderContainer,o=a.id,c=function(){le(r,function(){t(),n._customContainerReady(s,Nt,o)})};return i("lemon-contact",X()([{class:{"lemon-contact--active":this.currentContactId==e.contact.id}},{props:e},{on:{click:c}}]))},_renderSidebarContact:function(){var e,t=this,n=this.$createElement;return this._renderSidebar(this.contacts.map(function(i){i.index=i.index.replace(/\[[0-9]*\]/,"");var a=[i.index!==e&&n("p",{class:"lemon-sidebar__label"},[i.index]),t._renderContact({contact:i,simple:!0},function(){return t.changeContact(i.id)})];return e=i.index,a}),_t)},_renderSidebar:function(e,t){var n=this.$createElement;return n("div",{class:"lemon-sidebar",directives:[{name:"show",value:this.activeSidebar==t}]},[e])},_renderDrawer:function(){var e=this.$createElement;return this._menuIsMessages()&&this.currentContactId?e("div",{class:"lemon-drawer"},[qt(),re(this.$scopedSlots.drawer,"",this.currentContact)]):""},_isContactContainerCache:function(e){return e.startsWith("contact#")},_renderContainer:function(){var e=this,t=this.$createElement,n=[],i="lemon-container",a=this.currentContact,r=!0;for(var s in Nt.get()){var o=a.id==s&&this.currentIsDefSidebar;r=!o,n.push(t("div",{class:i,directives:[{name:"show",value:o}]},[Nt.get(s)]))}for(var c in Bt.get())n.push(t("div",{class:i,directives:[{name:"show",value:this.activeSidebar==c&&!this.currentIsDefSidebar}]},[Bt.get(c)]));return n.push(t("div",{class:i,directives:[{name:"show",value:this._menuIsMessages()&&r&&a.id}]},[t("div",{class:"lemon-container__title"},[t("div",{class:"lemon-container__displayname"},[re(this.$scopedSlots["contact-title"],a.displayName,a)])]),t("lemon-messages",{ref:"messages",attrs:{"time-format":this.messageTimeFormat,"reverse-user-id":this.user.id,messages:this.currentMessages},on:{"reach-top":this._handleReachTop}}),t("lemon-editor",{ref:"editor",on:{send:this._handleSend,upload:this._handleUpload}})])),n.push(t("div",{class:i,directives:[{name:"show",value:!a.id}]},[this.$slots.cover])),n.push(t("div",{class:i,directives:[{name:"show",value:this._menuIsContacts()&&r&&a.id}]},[re(this.$scopedSlots["contact-info"],t("div",{class:"lemon-contact-info"},[t("lemon-avatar",{attrs:{src:a.avatar,size:90}}),t("h4",[a.displayName]),t("lemon-button",{on:{click:function(){e.changeContact(a.id,yt)}}},[" ","发送消息"," "])]),a)])),n},_addContact:function(e,t){var n={0:"unshift",1:"push"}[t];Dt(e),this.contacts[n](e)},_addMessage:function(e,t,n){var i,a={0:"unshift",1:"push"}[n];Array.isArray(e)||(e=[e]),Vt[t]=Vt[t]||[],(i=Vt[t])[a].apply(i,Object(xt["a"])(e)),this.forceUpdateMessage()},setLastContentRender:function(e,t){St[e]=t},lastContentRender:function(e){return St[e.type].call(this,e)},replaceEmojiName:function(e){return e.replace(/\[!(\w+)\]/gi,function(e,t){var n=t;return Ht[n]?'<img src="'.concat(Ht[n],'" />'):"[!".concat(t,"]")})},messageViewToBottom:function(){this.$refs.messages.scrollToBottom()},changeContact:function(e,t){var n=this;this.currentContactId==e&&(this.currentContactId=void 0),t&&this.changeMenu(t),this.currentContactId=e,this.$emit("change-contact",this.currentContact),ae(this.currentContact.renderContainer)||this._menuIsMessages()&&(At.has(e)||this.$refs.messages.resetLoadState(),Vt[e]?this.messageViewToBottom():this.$emit("pull-messages",this.currentContact,function(t,i){n._addMessage(t,e,0),n.messageViewToBottom()}))},removeMessage:function(e,t){var n=this.findMessageIndexById(e,t);-1!==n&&(Vt[t].splice(n,1),this.forceUpdateMessage())},updateMessage:function(e,t,n){var i=this.findMessageIndexById(e,t);-1!==i&&(Vt[t][i]=Lt({},Vt[t][i],{},n),this.forceUpdateMessage(e))},forceUpdateMessage:function(e){if(e){var t=this.$refs.messages.$refs.message;if(t){var n=t.find(function(t){return t.$attrs.message.id==e});n&&n.$forceUpdate()}}else this.$refs.messages.$forceUpdate()},_customContainerReady:function(e,t,n){ae(e)&&!t.has(n)&&t.set(n,e.call(this))},changeMenu:function(e){this.$emit("change-menu",e),this.activeSidebar=e;var t=this.currentMenu.renderContainer;this._customContainerReady(t,Bt,e)},initEmoji:function(e){this.$refs.editor.initEmoji(e),e[0].label&&(e=e.flatMap(function(e){return e.children})),e.forEach(function(e){var t=e.name,n=e.src;return Ht[t]=n})},initMenus:function(e){var t=this.$createElement,n=[{name:yt,title:"聊天",unread:0,click:null,render:function(e){return t("i",{class:"lemon-icon-message"})},isBottom:!1},{name:_t,title:"通讯录",unread:0,click:null,render:function(e){return t("i",{class:"lemon-icon-addressbook"})},isBottom:!1}],i=[];if(Array.isArray(e)){var a={lastMessages:0,contacts:1},r=Object.keys(a);i=e.map(function(e){return r.includes(e.name)?Lt({},n[a[e.name]],{},e,{},{renderContainer:null}):e})}else i=n;this.menus=i},initContacts:function(e){var t;(t=this.contacts).push.apply(t,Object(xt["a"])(e)),this.sortContacts()},sortContacts:function(){this.contacts.sort(function(e,t){return e.index.localeCompare(t.index)})},updateContact:function(e,t){delete t.id,delete t.toContactId;var n=this.findContactIndexById(e);if(-1!==n){var i=t.unread;te(i)&&(0!==i.indexOf("+")&&0!==i.indexOf("-")||(t.unread=parseInt(i)+parseInt(this.contacts[n].unread))),this.$set(this.contacts,n,Lt({},this.contacts[n],{},t))}},findContactIndexById:function(e){return this.contacts.findIndex(function(t){return t.id==e})},findMessageIndexById:function(e,t){var n=Vt[t];return ie(n)?-1:n.findIndex(function(t){return t.id==e})},findMessageById:function(e,t){var n=this.findMessageIndexById(e,t);if(-1!==n)return Vt[t][n]},getContacts:function(){return this.contacts},getMessages:function(){return Vt},openrenderContainer:function(e){},changeDrawer:function(e){this.drawerVisible=!this.drawerVisible,1==this.drawerVisible&&this.openDrawer(e)},openDrawer:function(e){qt=e||new Function,this.drawerVisible=!0},closeDrawer:function(){this.drawerVisible=!1}}},Wt=Kt,zt=(n("9b01"),Object(C["a"])(Wt,Rt,Ut,!1,null,null,null)),Yt=zt.exports,Gt=(n("6a2b"),"0.1"),Qt=[Yt,Se,Re,De,J,z,H,N,T,Ae,Qe,at,pt,bt],Jt=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];Qt.forEach(function(t){e.component(t.name,t)})};"undefined"!==typeof window&&window.Vue&&Jt(window.Vue);var Zt={version:Gt,install:Jt};i["a"].use(Zt),i["a"].config.productionTip=!1,new i["a"]({render:function(e){return e(k)}}).$mount("#app")},cfab:function(e,t,n){"use strict";var i=n("15cf"),a=n.n(i);a.a},dbdc:function(e,t,n){"use strict";var i=n("7802"),a=n.n(i);a.a},e86c:function(e,t,n){},ed4b:function(e,t,n){"use strict";var i=n("a215"),a=n.n(i);a.a},fbd1:function(e,t,n){"use strict";var i=n("820e"),a=n.n(i);a.a}});